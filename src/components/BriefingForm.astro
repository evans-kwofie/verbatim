---

---

<section id="briefing" class="px-6 sm:px-8 md:px-12 lg:px-24 py-16 md:py-section border-t border-ink-faint">
  <div class="max-w-2xl mx-auto">
    <!-- Section header -->
    <div class="mb-12 md:mb-section">
      <span class="font-sans text-small tracking-widest uppercase text-ink-light">
        Begin
      </span>
      <h2 class="font-serif text-2xl md:text-heading mt-4">
        Your Briefing
      </h2>
      <p class="text-base md:text-body text-ink-light mt-4 max-w-md">
        Tell us where you are. We'll tell you what's possible.
      </p>
    </div>

    <!-- Multi-step form -->
    <form id="briefing-form" action="#" method="POST" class="relative">
      <!-- Step indicator -->
      <div class="mb-8 md:mb-12">
        <span id="step-indicator" class="font-sans text-small tracking-widest text-ink-light">
          01 / 04
        </span>
      </div>

      <!-- Step 1: Program & Level -->
      <div class="form-step" data-step="1">
        <div class="space-y-8 md:space-y-10">
          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4">
              Academic Level
            </label>
            <div class="flex flex-col sm:flex-row gap-4 sm:gap-6">
              <label class="inline-flex items-center gap-3 cursor-pointer group">
                <input type="radio" name="degreeType" value="undergraduate" class="sr-only peer" />
                <span class="w-4 h-4 border border-ink-faint rounded-full peer-checked:border-ink peer-checked:bg-ink transition-all duration-300 shrink-0"></span>
                <span class="font-sans text-base md:text-body text-ink-light peer-checked:text-ink transition-colors duration-300">Undergraduate</span>
              </label>
              <label class="inline-flex items-center gap-3 cursor-pointer group">
                <input type="radio" name="degreeType" value="masters" class="sr-only peer" />
                <span class="w-4 h-4 border border-ink-faint rounded-full peer-checked:border-ink peer-checked:bg-ink transition-all duration-300 shrink-0"></span>
                <span class="font-sans text-base md:text-body text-ink-light peer-checked:text-ink transition-colors duration-300">Master's</span>
              </label>
            </div>
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="work-type">
              Type of Work
            </label>
            <div class="flex flex-col sm:flex-row gap-4 sm:gap-6">
              <label class="inline-flex items-center gap-3 cursor-pointer group">
                <input type="radio" name="workType" value="essay" class="sr-only peer" />
                <span class="w-4 h-4 border border-ink-faint rounded-full peer-checked:border-ink peer-checked:bg-ink transition-all duration-300 shrink-0"></span>
                <span class="font-sans text-base md:text-body text-ink-light peer-checked:text-ink transition-colors duration-300">Essay</span>
              </label>
              <label class="inline-flex items-center gap-3 cursor-pointer group">
                <input type="radio" name="workType" value="thesis" class="sr-only peer" />
                <span class="w-4 h-4 border border-ink-faint rounded-full peer-checked:border-ink peer-checked:bg-ink transition-all duration-300 shrink-0"></span>
                <span class="font-sans text-base md:text-body text-ink-light peer-checked:text-ink transition-colors duration-300">Thesis</span>
              </label>
              <label class="inline-flex items-center gap-3 cursor-pointer group">
                <input type="radio" name="workType" value="dissertation" class="sr-only peer" />
                <span class="w-4 h-4 border border-ink-faint rounded-full peer-checked:border-ink peer-checked:bg-ink transition-all duration-300 shrink-0"></span>
                <span class="font-sans text-base md:text-body text-ink-light peer-checked:text-ink transition-colors duration-300">Dissertation</span>
              </label>
            </div>
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="field">
              Field of Study
            </label>
            <input
              type="text"
              id="field"
              name="field"
              placeholder="e.g., Business Administration"
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300"
            />
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="university">
              University
            </label>
            <input
              type="text"
              id="university"
              name="university"
              placeholder="e.g., KNUST"
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300"
            />
          </div>
        </div>
      </div>

      <!-- Step 2: Writing Stage -->
      <div class="form-step hidden" data-step="2">
        <div class="space-y-8 md:space-y-10">
          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-6">
              Where are you in the process?
            </label>
            <div class="space-y-4">
              {['Proposal stage — shaping the question', 'First draft — structure exists, needs refinement', 'Revision — feedback received, path unclear', 'Stalled — significant work done, momentum lost'].map((option, i) => (
                <label class="flex items-start gap-4 cursor-pointer group py-3 border-b border-ink-faint/50 last:border-0">
                  <input type="radio" name="writingStage" value={`stage-${i + 1}`} class="sr-only peer" />
                  <span class="mt-1 w-3 h-3 border border-ink-faint rounded-full peer-checked:border-ink peer-checked:bg-ink transition-all duration-300 shrink-0"></span>
                  <span class="font-sans text-base md:text-body text-ink-light peer-checked:text-ink transition-colors duration-300">{option}</span>
                </label>
              ))}
            </div>
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="deadline">
              Target Completion
            </label>
            <input
              type="text"
              id="deadline"
              name="deadline"
              placeholder="e.g., September 2026"
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300"
            />
          </div>
        </div>
      </div>

      <!-- Step 3: Service Tier -->
      <div class="form-step hidden" data-step="3">
        <div class="space-y-8 md:space-y-10">
          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-6">
              Level of Engagement
            </label>
            <div class="space-y-0">
              {[
                { value: 'structural-review', name: 'Structural Review', desc: "You've written it. We fix the logic." },
                { value: 'architecture', name: 'Architecture', desc: 'We build the outline and research base.' },
                { value: 'full-articulation', name: 'Full Articulation', desc: 'The Verbatim experience.' },
              ].map((tier) => (
                <label class="block cursor-pointer group py-5 md:py-6 border-b border-ink-faint last:border-0">
                  <input type="radio" name="serviceTier" value={tier.value} class="sr-only peer" />
                  <div class="flex items-start justify-between gap-4">
                    <div class="flex-1 min-w-0">
                      <span class="font-serif text-lg md:text-subheading text-ink-light peer-checked:group-[]:text-ink transition-colors duration-300 block">
                        {tier.name}
                      </span>
                      <span class="font-sans text-sm md:text-body text-ink-light/60 mt-1 block">
                        {tier.desc}
                      </span>
                    </div>
                    <span class="mt-1 w-4 h-4 border border-ink-faint rounded-full peer-checked:group-[]:border-ink peer-checked:group-[]:bg-ink transition-all duration-300 shrink-0"></span>
                  </div>
                </label>
              ))}
            </div>
          </div>
        </div>
      </div>

      <!-- Step 4: Contact -->
      <div class="form-step hidden" data-step="4">
        <div class="space-y-8 md:space-y-10">
          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="name">
              Full Name
            </label>
            <input
              type="text"
              id="name"
              name="name"
              placeholder="Your name"
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300"
            />
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="phone">
              WhatsApp Number
            </label>
            <input
              type="tel"
              id="phone"
              name="phone"
              placeholder="e.g., 024 XXX XXXX"
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300"
            />
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="email">
              Email Address
            </label>
            <input
              type="email"
              id="email"
              name="email"
              placeholder="your@email.com"
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300"
            />
          </div>

          <div class="form-field">
            <label class="font-serif text-lg md:text-subheading block mb-4" for="brief">
              Brief Description
            </label>
            <textarea
              id="brief"
              name="brief"
              rows="4"
              placeholder="Describe your essay or thesis and what you need from us..."
              class="w-full bg-transparent border-0 border-b border-ink-faint pb-3 font-sans text-base md:text-body text-ink placeholder:text-ink-light/50 focus:border-ink focus:outline-none transition-colors duration-300 resize-none"
            ></textarea>
          </div>
        </div>
      </div>

      <!-- Navigation buttons -->
      <div class="flex items-center justify-between mt-10 md:mt-16">
        <button
          type="button"
          id="btn-prev"
          class="font-sans text-small tracking-widest uppercase text-ink-light hover:text-ink transition-colors duration-300 invisible"
        >
          Back
        </button>

        <button
          type="button"
          id="btn-next"
          class="group inline-flex items-center gap-3 md:gap-4 bg-ink text-paper px-6 md:px-10 py-3.5 md:py-4 font-sans text-small tracking-widest uppercase hover:bg-accent transition-colors duration-300"
        >
          <span>Continue</span>
          <span class="block w-6 h-px bg-current transition-all duration-300 group-hover:w-10"></span>
        </button>

        <button
          type="submit"
          id="btn-submit"
          class="group inline-flex items-center gap-3 md:gap-4 bg-ink text-paper px-6 md:px-10 py-3.5 md:py-4 font-sans text-small tracking-widest uppercase hover:bg-accent transition-colors duration-300 hidden"
        >
          <span>Submit Briefing</span>
          <span class="block w-6 h-px bg-current transition-all duration-300 group-hover:w-10"></span>
        </button>
      </div>
    </form>

    <!-- Success message (hidden by default) -->
    <div id="form-success" class="hidden text-center py-16 md:py-section">
      <h3 class="font-serif text-2xl md:text-heading">Briefing Received.</h3>
      <p class="text-base md:text-body text-ink-light mt-4">
        We'll review your details and reach out on WhatsApp within 24 hours.
      </p>
    </div>
  </div>
</section>

<style>
  .form-step {
    transition: opacity 0.4s ease, transform 0.4s ease;
  }

  .form-step.hidden {
    display: none;
  }

  .form-step.leaving {
    opacity: 0;
    transform: translateX(-20px);
  }

  .form-step.entering {
    opacity: 0;
    transform: translateX(20px);
  }
</style>

<script is:inline>
  (function () {
    var form = document.getElementById('briefing-form');
    var steps = document.querySelectorAll('.form-step');
    var indicator = document.getElementById('step-indicator');
    var btnPrev = document.getElementById('btn-prev');
    var btnNext = document.getElementById('btn-next');
    var btnSubmit = document.getElementById('btn-submit');
    var successMsg = document.getElementById('form-success');
    var totalSteps = steps.length;
    var currentStep = 1;

    // Pre-fill tier from calculator link
    var urlParams = new URLSearchParams(window.location.search);
    var preselectedTier = urlParams.get('tier');

    // Validation rules per step
    var stepValidation = {
      1: function () {
        var degreeType = form.querySelector('input[name="degreeType"]:checked');
        var workType = form.querySelector('input[name="workType"]:checked');
        var field = form.querySelector('#field').value.trim();
        var university = form.querySelector('#university').value.trim();
        var errors = [];
        if (!degreeType) errors.push('Please select your academic level.');
        if (!workType) errors.push('Please select the type of work.');
        if (!field) errors.push('Please enter your field of study.');
        if (!university) errors.push('Please enter your university.');
        return errors;
      },
      2: function () {
        var stage = form.querySelector('input[name="writingStage"]:checked');
        var deadline = form.querySelector('#deadline').value.trim();
        var errors = [];
        if (!stage) errors.push('Please select where you are in the process.');
        if (!deadline) errors.push('Please enter a target completion date.');
        return errors;
      },
      3: function () {
        var tier = form.querySelector('input[name="serviceTier"]:checked');
        var errors = [];
        if (!tier) errors.push('Please select a level of engagement.');
        return errors;
      },
      4: function () {
        var name = form.querySelector('#name').value.trim();
        var phone = form.querySelector('#phone').value.trim();
        var email = form.querySelector('#email').value.trim();
        var brief = form.querySelector('#brief').value.trim();
        var errors = [];
        if (!name) errors.push('Please enter your full name.');
        if (!phone) errors.push('Please enter your WhatsApp number.');
        if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) errors.push('Please enter a valid email address.');
        if (!brief) errors.push('Please describe what you need from us.');
        return errors;
      }
    };

    function clearErrors() {
      var existing = form.querySelectorAll('.form-error');
      existing.forEach(function (el) { el.remove(); });
    }

    function showErrors(errors) {
      clearErrors();
      if (errors.length === 0) return;
      var container = document.createElement('div');
      container.className = 'form-error mt-6 p-4 border border-accent/40 bg-accent/5';
      errors.forEach(function (msg) {
        var p = document.createElement('p');
        p.className = 'font-sans text-sm text-accent';
        p.textContent = msg;
        container.appendChild(p);
      });
      var activeStep = form.querySelector('[data-step="' + currentStep + '"]');
      if (activeStep) activeStep.appendChild(container);
    }

    function validateStep(step) {
      var validator = stepValidation[step];
      if (!validator) return true;
      var errors = validator();
      if (errors.length > 0) {
        showErrors(errors);
        return false;
      }
      clearErrors();
      return true;
    }

    function showStep(step) {
      steps.forEach(function (s) {
        s.classList.add('hidden');
      });

      var target = document.querySelector('[data-step="' + step + '"]');
      if (target) {
        target.classList.remove('hidden');
      }

      indicator.textContent = '0' + step + ' / 0' + totalSteps;
      btnPrev.style.visibility = step > 1 ? 'visible' : 'hidden';

      if (step === totalSteps) {
        btnNext.classList.add('hidden');
        btnSubmit.classList.remove('hidden');
      } else {
        btnNext.classList.remove('hidden');
        btnSubmit.classList.add('hidden');
      }
    }

    btnNext.addEventListener('click', function () {
      if (!validateStep(currentStep)) return;
      if (currentStep < totalSteps) {
        currentStep++;
        showStep(currentStep);
      }
    });

    btnPrev.addEventListener('click', function () {
      clearErrors();
      if (currentStep > 1) {
        currentStep--;
        showStep(currentStep);
      }
    });

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      if (!validateStep(currentStep)) return;

      var formData = new FormData(form);
      var data = Object.fromEntries(formData.entries());
      console.log('Briefing submitted:', data);

      form.classList.add('hidden');
      successMsg.classList.remove('hidden');
    });

    // Handle tier pre-selection from calculator
    if (preselectedTier) {
      var tierInput = document.querySelector('input[value="' + preselectedTier + '"]');
      if (tierInput) {
        tierInput.checked = true;
      }
    }

    // Handle tier links from calculator
    document.querySelectorAll('[data-tier]').forEach(function (link) {
      link.addEventListener('click', function (e) {
        var tierName = e.currentTarget.dataset.tier;
        var tierMap = {
          'Structural Review': 'structural-review',
          'Architecture': 'architecture',
          'Full Articulation': 'full-articulation',
        };
        var value = tierMap[tierName];
        if (value) {
          setTimeout(function () {
            var tierInput = document.querySelector('input[name="serviceTier"][value="' + value + '"]');
            if (tierInput) {
              tierInput.checked = true;
            }
          }, 600);
        }
      });
    });

    showStep(1);
  })();
</script>
